version: 2

models:
  - name: int_patient_registrations
    description: |
      Comprehensive patient registration history across practices.
      Tracks all practice registrations including start/end dates and registration status.
      Includes ALL persons following intermediate layer principles.
    columns:
      - name: person_id
        description: "Unique person identifier"
        tests:
          - not_null
      - name: patient_id
        description: "Patient identifier (can change with practice moves)"
        tests:
          - not_null
      - name: practice_id
        description: "Practice identifier where patient is/was registered"
        tests:
          - not_null
      - name: practice_code
        description: "Organisation code of the practice"
        tests:
          - not_null
      - name: practice_name
        description: "Name of the practice"
        tests:
          - not_null
      - name: registration_start_date
        description: "Date patient registered at this practice"
        tests:
          - not_null
      - name: registration_end_date
        description: "Date patient left this practice (NULL if currently registered)"
      - name: is_current_registration
        description: "Flag indicating if this is the patient's current practice"
        tests:
          - not_null
          - accepted_values:
              values: [true, false]
      - name: registration_status
        description: "Status of the registration (Active, Ended, etc.)"
        tests:
          - not_null 