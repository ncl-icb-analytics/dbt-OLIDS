version: 2
models:
- name: int_valproate_medications_all
  description: 'Intermediate: Valproate Medication Orders - All recorded valproate prescriptions for pregnancy safety monitoring.


    Clinical Purpose:

    • Tracks valproate therapy for seizure management and bipolar disorder treatment

    • Supports pregnancy safety monitoring and teratogenicity risk assessment

    • Enables valproate programme oversight and clinical safety interventions


    Data Granularity:

    • One row per medication order

    • Includes all patients regardless of status (active/inactive/deceased)

    • Historical data maintained for longitudinal safety analysis


    Key Features:

    • Dual matching logic (medication name patterns and concept ID validation)

    • High teratogenic risk flagging with clinical indication classification

    • Dose categorisation and formulation type for bioequivalence monitoring

    • Critical for pregnancy + valproate safety combination detection'

  columns:
  - name: person_id
    description: Unique person identifier across the HEI system

    tests:
    - not_null
  - name: medication_order_id
    description: Unique identifier for the medication order record

    tests:
    - not_null
    - unique
  - name: order_date
    description: Date the valproate medication was ordered

    tests:
    - not_null
  - name: valproate_product_type
    description: Specific valproate product type for brand monitoring

    tests:
    - not_null
  - name: clinical_indication
    description: Primary clinical indication for valproate therapy

    tests:
    - not_null
    - accepted_values:

        values:
        - ANTI_EPILEPTIC
        - MOOD_STABILISER
        - UNSPECIFIED
  - name: is_high_teratogenic_risk
    description: Boolean flag indicating high teratogenicity risk (always TRUE for valproate)

    tests:
    - not_null
    - accepted_values:

        values:
        - true
  - name: dose_category
    description: Dosage category for therapeutic monitoring

    tests:
    - not_null
    - accepted_values:

        values:
        - LOW_DOSE
        - MODERATE_DOSE
        - HIGH_DOSE
        - UNKNOWN_DOSE
  - name: formulation_type
    description: Formulation type for bioequivalence monitoring

    tests:
    - not_null
    - accepted_values:

        values:
        - TABLET
        - CAPSULE
        - LIQUID
        - MODIFIED_RELEASE
        - UNKNOWN_FORMULATION
  - name: matched_on_name
    description: Boolean flag indicating medication name-based matching

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: matched_on_concept_id
    description: Boolean flag indicating concept ID-based matching

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_recent_3m
    description: Boolean flag indicating order within last 3 months

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_recent_6m
    description: Boolean flag indicating order within last 6 months

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_recent_12m
    description: Boolean flag indicating order within last 12 months

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
