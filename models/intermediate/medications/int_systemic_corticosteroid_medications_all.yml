version: 2
models:
- name: int_systemic_corticosteroid_medications_all
  description: 'Intermediate: Systemic Corticosteroid Medication Orders - All recorded systemic steroid prescriptions.


    Clinical Purpose:

    • Tracks systemic corticosteroid therapy for inflammatory conditions

    • Supports steroid monitoring and safety management processes

    • Enables analysis of high-dose therapy and replacement vs anti-inflammatory usage


    Data Granularity:

    • One row per medication order

    • Includes all patients regardless of status (active/inactive/deceased)

    • Historical data maintained for longitudinal analysis


    Key Features:

    • Classification by corticosteroid type (replacement, glucocorticoid, mineralocorticoid)

    • Potency stratification relative to hydrocortisone equivalence

    • High-dose therapy identification for safety monitoring

    • Short-term recency flags for steroid withdrawal assessment'
  columns:
  - name: person_id
    description: Unique person identifier across the HEI system
    tests:
    - not_null
  - name: medication_order_id
    description: Unique identifier for the medication order record
    tests:
    - not_null
    - unique
  - name: corticosteroid_type
    description: Corticosteroid therapy type classification
    tests:
    - not_null
    - accepted_values:
        values:
        - REPLACEMENT
        - GLUCOCORTICOID
        - MINERALOCORTICOID
        - OTHER_CORTICOSTEROID
  - name: specific_corticosteroid
    description: Specific corticosteroid medication type
    tests:
    - not_null
    - accepted_values:
        values:
        - PREDNISOLONE
        - HYDROCORTISONE
        - DEXAMETHASONE
        - METHYLPREDNISOLONE
        - BETAMETHASONE
        - DEFLAZACORT
        - FLUDROCORTISONE
        - OTHER_CORTICOSTEROID
  - name: potency_classification
    description: Corticosteroid potency relative to hydrocortisone
    tests:
    - not_null
    - accepted_values:
        values:
        - LOW_POTENCY
        - MEDIUM_POTENCY
        - HIGH_POTENCY
        - UNKNOWN_POTENCY
  - name: is_prednisolone
    description: Boolean flag indicating prednisolone use (most common oral steroid)
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_hydrocortisone
    description: Boolean flag indicating hydrocortisone use
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_replacement_therapy
    description: Boolean flag indicating replacement therapy use
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_anti_inflammatory
    description: Boolean flag indicating anti-inflammatory therapy use
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_high_dose
    description: Boolean flag indicating high-dose steroid therapy requiring monitoring
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_recent_1m
    description: Boolean flag indicating if order was within the last month
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - person_id
      - medication_order_id
  - bnf_codes_exist:
      bnf_codes: '0603'
