version: 2
models:
- name: int_antidepressant_medications_all
  description: 'Intermediate: Antidepressant Medication Orders - All recorded antidepressant prescriptions.


    Clinical Purpose:

    • Tracks antidepressant therapy for mental health conditions

    • Supports depression management and medication review processes

    • Enables analysis of prescribing patterns by antidepressant class and NICE guidance compliance


    Data Granularity:

    • One row per medication order

    • Includes all patients regardless of status (active/inactive/deceased)

    • Historical data maintained for longitudinal analysis


    Key Features:

    • Classification by antidepressant class (SSRI, SNRI, tricyclic, MAOI)

    • Specific medication mapping with first-line therapy indicators

    • NICE guidance compliance flags for treatment recommendations

    • Recency indicators for therapy monitoring (3m, 6m, 12m)'
  columns:
  - name: person_id
    description: Unique person identifier across the HEI system
    tests:
    - not_null
  - name: medication_order_id
    description: Unique identifier for the medication order record
    tests:
    - not_null
    - unique
  - name: antidepressant_class
    description: Antidepressant drug class classification
    tests:
    - not_null
    - accepted_values:
        values:
        - TRICYCLIC
        - MAOI
        - SSRI
        - OTHER_ANTIDEPRESSANTS
        - UNKNOWN_ANTIDEPRESSANT
  - name: specific_antidepressant
    description: Specific antidepressant medication type
    tests:
    - not_null
    - accepted_values:
        values:
        - CITALOPRAM
        - ESCITALOPRAM
        - FLUOXETINE
        - PAROXETINE
        - SERTRALINE
        - VENLAFAXINE
        - DULOXETINE
        - MIRTAZAPINE
        - AMITRIPTYLINE
        - DOSULEPIN
        - NORTRIPTYLINE
        - OTHER_ANTIDEPRESSANT
  - name: is_citalopram
    description: Boolean flag indicating citalopram use
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_sertraline
    description: Boolean flag indicating sertraline use
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_fluoxetine
    description: Boolean flag indicating fluoxetine use
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_ssri
    description: Boolean flag indicating SSRI class antidepressant
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_tricyclic
    description: Boolean flag indicating tricyclic antidepressant
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_snri
    description: Boolean flag indicating SNRI class antidepressant
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_first_line
    description: Boolean flag indicating first-line antidepressant (NICE guidance)
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - person_id
      - medication_order_id
  - bnf_codes_exist:
      bnf_codes: '0403'
