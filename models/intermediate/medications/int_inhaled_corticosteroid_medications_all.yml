version: 2
models:
- name: int_inhaled_corticosteroid_medications_all
  description: 'Intermediate: Inhaled Corticosteroid Medication Orders - All recorded ICS prescriptions for respiratory conditions.


    Clinical Purpose:

    • Tracks inhaled corticosteroid therapy for asthma and COPD management

    • Supports respiratory disease monitoring and medication review processes

    • Enables analysis of single agent vs combination therapy patterns


    Data Granularity:

    • One row per medication order

    • Includes all patients regardless of status (active/inactive/deceased)

    • Historical data maintained for longitudinal analysis


    Key Features:

    • Classification by ICS type (single agent vs combination preparations)

    • Specific corticosteroid identification (beclometasone, budesonide, fluticasone)

    • Combination therapy mapping (ICS/LABA preparations)

    • MART therapy eligibility flags for asthma management'

  columns:
  - name: person_id
    description: Unique person identifier across the HEI system

    tests:
    - not_null
  - name: medication_order_id
    description: Unique identifier for the medication order record

    tests:
    - not_null
    - unique
  - name: ics_type
    description: Inhaled corticosteroid preparation type

    tests:
    - not_null
    - accepted_values:

        values:
        - SINGLE_AGENT
        - COMBINATION
        - OTHER_ICS
  - name: specific_ics
    description: Specific inhaled corticosteroid medication type

    tests:
    - not_null
    - accepted_values:

        values:
        - BECLOMETASONE
        - BUDESONIDE
        - CICLESONIDE
        - FLUTICASONE
        - MOMETASONE
        - OTHER_ICS
  - name: combination_type
    description: Specific combination therapy type (ICS + LABA)

    tests:
    - accepted_values:

        values:
        - BUDESONIDE_FORMOTEROL
        - FLUTICASONE_SALMETEROL
        - FLUTICASONE_VILANTEROL
        - BECLOMETASONE_FORMOTEROL
        - OTHER_COMBINATION
  - name: is_beclometasone
    description: Boolean flag indicating beclometasone use

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_budesonide
    description: Boolean flag indicating budesonide use

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_fluticasone
    description: Boolean flag indicating fluticasone use

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_single_agent
    description: Boolean flag indicating single agent ICS therapy

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_combination_therapy
    description: Boolean flag indicating combination ICS/LABA therapy

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_mart_eligible
    description: Boolean flag indicating MART (Maintenance and Reliever Therapy) eligibility

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false

  tests:
  - dbt_utils.unique_combination_of_columns:

      combination_of_columns:
      - person_id
      - medication_order_id
  - bnf_codes_exist:
      bnf_codes: '0302'
