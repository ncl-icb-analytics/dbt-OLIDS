version: 2
models:
- name: int_cardiac_glycoside_medications_all
  description: 'Intermediate: Cardiac Glycoside Medication Orders - All recorded cardiac glycoside prescriptions.


    Clinical Purpose:

    • Tracks cardiac glycoside therapy for heart failure and arrhythmia management

    • Supports therapeutic drug monitoring and medication safety processes

    • Enables analysis of dosing patterns for elderly and renal impairment


    Data Granularity:

    • One row per medication order

    • Includes all patients regardless of status (active/inactive/deceased)

    • Historical data maintained for longitudinal analysis


    Key Features:

    • Specific cardiac glycoside identification (primarily digoxin)

    • Dose categorisation with clinical indication mapping

    • Special population dosing flags (elderly/renal impairment)

    • Therapeutic monitoring indicators for safety management'
  columns:
  - name: person_id
    description: Unique person identifier across the HEI system
    tests:
    - not_null
  - name: medication_order_id
    description: Unique identifier for the medication order record
    tests:
    - not_null
    - unique
  - name: cardiac_glycoside_type
    description: Specific cardiac glycoside medication type
    tests:
    - not_null
    - accepted_values:
        values:
        - DIGOXIN
        - DIGITOXIN
        - OTHER_CARDIAC_GLYCOSIDE
  - name: is_digoxin
    description: Boolean flag indicating digoxin use (most common cardiac glycoside)
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: digoxin_dose_category
    description: Digoxin dose classification for therapeutic monitoring
    tests:
    - not_null
    - accepted_values:
        values:
        - STANDARD_DOSE
        - HIGH_DOSE
        - LOW_DOSE
        - UNKNOWN_DOSE
  - name: is_heart_failure_dose
    description: Boolean flag indicating typical heart failure dosing
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_arrhythmia_dose
    description: Boolean flag indicating higher dose for arrhythmia control
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_elderly_renal_dose
    description: Boolean flag indicating reduced dose for elderly or renal impairment
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - person_id
      - medication_order_id
  - bnf_codes_exist:
      bnf_codes: '020101'
