version: 2
models:
- name: int_pregnancy_absence_risk_all
  description: 'Intermediate: Pregnancy Absence Risk All - Complete history of all observations indicating permanent absence of pregnancy risk for clinical safety.


    Clinical Purpose:

    • Valproate medication safety monitoring and pregnancy risk assessment

    • Clinical decision support for contraindicated medications during pregnancy

    • Safety-critical pharmaceutical prescribing and monitoring

    • Reproductive health risk stratification and patient safety protocols


    Data Granularity:

    • One row per pregnancy absence risk observation

    • Uses PREGRISK category codes from valproate programme

    • Includes all patients regardless of status for comprehensive safety monitoring


    Key Features:

    • Permanent pregnancy risk absence indicators for medication safety

    • Critical for teratogenic medication prescribing decisions

    • Essential for clinical safety and pharmaceutical risk management

    • Supports reproductive health and medication safety protocols'
  config:
    materialized: table
  columns:
  - name: person_id
    description: Unique person identifier
    tests:
    - not_null
    - relationships:
        to: ref('dim_person')
        field: person_id
  - name: clinical_effective_date
    description: Date when observation was clinically effective
    tests:
    - not_null
  - name: concept_code
    description: SNOMED concept code for pregnancy risk absence observation
    tests:
    - not_null
  - name: concept_display
    description: Human-readable display term for concept code
    tests:
    - not_null
  - name: source_cluster_id
    description: Source cluster ID from mapped concepts
    tests:
    - not_null
  - name: code_category
    description: Code category from valproate programme (always 'PREGRISK')
    tests:
    - not_null
    - accepted_values:
        values:
        - PREGRISK
  - name: lookback_years_offset
    description: Lookback period in years for code validity (NULL = all historical)
  - name: date_recorded
    description: Date when observation was recorded in system
  - name: lds_datetime_data_acquired
    description: LDS processing timestamp
