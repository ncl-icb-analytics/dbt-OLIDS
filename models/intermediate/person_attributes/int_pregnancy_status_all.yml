version: 2
models:
- name: int_pregnancy_status_all
  tests:
  - cluster_ids_exist:
      cluster_ids: PREGDEL_COD, PREG_COD
  description: 'Intermediate: Pregnancy Status All - Complete history of all pregnancy-related observations.


Clinical Purpose:

• Pregnancy status tracking and maternity care pathway coordination

• Medication safety monitoring during pregnancy and post-pregnancy periods

• Clinical decision support for pregnancy-contraindicated treatments


Data Granularity:

• One row per pregnancy-related observation with enhanced timeframe analysis

• Uses PREG_COD (pregnancy status) and PREGDEL_COD (delivery events) QOF clusters

• Includes all patients regardless of status for comprehensive maternity care


Key Features:

• Enhanced pregnancy status categorisation and clinical safety context

• Maternity care timeframe analysis for clinical decision support
• Pregnancy outcome tracking including live births and terminations'

  config:
    materialized: table

  columns:
  - name: person_id
    description: Unique person identifier

    tests:
    - not_null
    - relationships:
        to: ref('dim_person')
        field: person_id
  - name: clinical_effective_date
    description: Date when pregnancy observation was clinically effective

    tests:
    - not_null
  - name: concept_code
    description: SNOMED concept code for pregnancy observation

    tests:
    - not_null
  - name: concept_display
    description: Human-readable display term for concept code

    tests:
    - not_null
  - name: source_cluster_id
    description: Source cluster ID (PREG_COD or PREGDEL_COD)

    tests:
    - not_null
    - accepted_values:

        values:
        - PREG_COD
        - PREGDEL_COD
  - name: is_pregnancy_code
    description: Flag indicating if observation is a pregnancy code (PREG_COD)

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: date_recorded
    description: Date when observation was recorded in system
  - name: lds_datetime_data_acquired
    description: LDS processing timestamp
