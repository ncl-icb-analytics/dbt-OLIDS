version: 2
models:
- name: int_smoking_status_latest
  description: 'Intermediate: Smoking Status Latest - Most recent smoking status per person for current clinical decision support and QOF reporting.


    Clinical Purpose:

    • Current smoking status determination for clinical decision support

    • QOF smoking indicator extraction and cardiovascular risk assessment

    • Real-time lifestyle intervention eligibility and patient safety protocols

    • Smoking cessation programme targeting and health improvement tracking


    Data Granularity:

    • One row per person representing most recent smoking status observation

    • Uses QOF cluster prioritisation for specific status codes

    • Includes all persons regardless of status for comprehensive QOF reporting


    Key Features:

    • Latest smoking status with specific code prioritisation over general codes

    • Current clinical decision support for CVD risk and intervention planning

    • QOF-compliant smoking status determination for reporting

    • Essential for real-time lifestyle intervention and patient safety protocols'
  columns:
  - name: person_id
    description: Unique person identifier
    tests:
    - not_null
    - unique
  - name: observation_id
    description: Unique observation identifier
    tests:
    - not_null
  - name: clinical_effective_date
    description: Date of the latest smoking status observation
    tests:
    - not_null
  - name: concept_code
    description: SNOMED concept code for smoking status
    tests:
    - not_null
  - name: source_cluster_id
    description: Source cluster ID
    tests:
    - not_null
  - name: is_smoker_code
    description: Flag indicating current smoker code
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_ex_smoker_code
    description: Flag indicating ex-smoker code
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_never_smoked_code
    description: Flag indicating never smoked code
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: smoking_status
    description: Latest smoking status category
    tests:
    - not_null
    - accepted_values:
        values:
        - Current Smoker
        - Ex-Smoker
        - Never Smoked
        - General Smoking Code
        - Unknown
  - name: is_current_smoker
    description: Flag indicating current smoking status
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_ex_smoker
    description: Flag indicating ex-smoker status
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
