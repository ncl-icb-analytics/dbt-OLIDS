version: 2
models:
- name: int_qrisk_latest
  description: 'Latest valid QRISK cardiovascular risk assessment per person.

    Filters to most recent valid QRISK score (0-100% range).

    '
  columns:
  - name: person_id
    description: Unique person identifier
    tests:
    - not_null
    - unique
  - name: clinical_effective_date
    description: Date of the QRISK assessment
    tests:
    - not_null
  - name: cvd_risk_category
    description: CVD risk category (excludes 'Invalid')
    tests:
    - not_null
    - accepted_values:
        values:
        - Low Risk (<10%)
        - Moderate Risk (10-20%)
        - "High Risk (\u226520%)"
  - name: is_high_cvd_risk
    description: "Flag indicating QRISK \u226520% (high risk)"
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
