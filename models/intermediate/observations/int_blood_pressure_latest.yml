version: 2
models:
- name: int_blood_pressure_latest
  description: 'Contains the latest blood pressure reading for each person, based on clinical_effective_date, derived from
    int_blood_pressure_all.

    '
  columns:
  - name: person_id
    description: Unique identifier for the person
    tests:
    - not_null
  - name: clinical_effective_date
    description: Timestamp of when the blood pressure reading is clinically effective (TIMESTAMP_NTZ)
    tests:
    - not_null
    - test_no_future_dates
  - name: systolic_value
    description: Systolic blood pressure value in mmHg
    tests:
    - dbt_utils.accepted_range:
        min_value: 40
        max_value: 350
        where: systolic_value is not null
  - name: diastolic_value
    description: Diastolic blood pressure value in mmHg
    tests:
    - dbt_utils.accepted_range:
        min_value: 20
        max_value: 200
        where: diastolic_value is not null
  - name: is_home_bp_event
    description: Flag indicating if reading was taken at home
    tests:
    - not_null
  - name: is_abpm_bp_event
    description: Flag indicating if reading was from ambulatory blood pressure monitoring
    tests:
    - not_null
  - name: systolic_observation_id
    description: Reference to source observation for systolic reading
  - name: diastolic_observation_id
    description: Reference to source observation for diastolic reading
  - name: all_concept_codes
    description: Array of all related concept codes for the readings
    tests:
    - not_null
  - name: all_concept_displays
    description: Array of all related concept display texts
    tests:
    - not_null
