{{ config(
    materialized='table',
    post_hook=[
        "COMMENT ON TABLE {{ this }} IS 'Intermediate: LTC LCS NHS Health Checks - Collects NHS health check completion observations for Long Term Conditions case finding exclusion logic.

Clinical Purpose:
â€¢ Gathers NHS health check completion data for case finding exclusion algorithms
â€¢ Supports identification of patients who have received recent health checks to avoid duplication
â€¢ Enables health check completion tracking for case finding programme logic
â€¢ Provides foundation data for excluding patients from case finding who have recent health assessments

Data Granularity:
â€¢ One row per NHS health check completion observation
â€¢ Covers health check completion events for case finding exclusion logic
â€¢ Sourced from LTC_LCS programme observation clusters for health check tracking
â€¢ Includes all historical and current NHS health check completion observations

Key Features:
â€¢ Cluster IDs: HEALTH_CHECK_COMP
â€¢ Supports health check completion tracking for case finding programme exclusions
â€¢ Health check lookback period logic for avoiding duplicate assessments
â€¢ Integration with LTC_LCS programme health check tracking systems

ðŸ¤– Generated by dbt. This table is managed by dbt - for model definitions and documentation, see https://github.com/ncl-icb-analytics/dbt-olids'"
    ]
) }}
-- Intermediate model for NHS health check observations for LTC LCS case finding
-- Used for health check completion tracking and exclusion logic

{{ get_observations(
    cluster_ids="'HEALTH_CHECK_COMP'",
    source='LTC_LCS'
) }}
