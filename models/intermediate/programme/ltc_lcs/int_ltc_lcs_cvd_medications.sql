{{ config(
    materialized='table',
    post_hook=[
        "COMMENT ON TABLE {{ this }} IS 'Intermediate: LTC LCS CVD Medications - Collects all cardiovascular disease-relevant medications for Long Term Conditions case finding measures.

Clinical Purpose:
â€¢ Gathers comprehensive CVD-related medication data for case finding algorithms
â€¢ Supports identification of patients requiring CVD risk assessment through medication patterns
â€¢ Enables medication-based risk stratification for CVD case finding measures
â€¢ Provides foundation data for CVD_63, CVD_64, CVD_65, and related case finding indicators

Data Granularity:
â€¢ One row per medication order for CVD-relevant medications
â€¢ Covers statin medications across multiple CVD case finding indicators
â€¢ Includes statin allergies, contraindications, and clinical decisions
â€¢ Sourced from LTC_LCS programme medication clusters

Key Features:
â€¢ Cluster IDs: STATIN_CVD_MEDICATIONS, STATIN_CVD_63_MEDICATIONS, STATIN_CVD_64_MEDICATIONS, STATIN_CVD_65_MEDICATIONS
â€¢ Supports cardiovascular risk assessment and primary prevention case finding
â€¢ Comprehensive medication pattern analysis for CVD risk stratification
â€¢ Integration with LTC_LCS programme medication tracking systems

ðŸ¤– Generated by dbt. This table is managed by dbt - for model definitions and documentation, see https://github.com/ncl-icb-analytics/snowflake-hei-migration'"
    ]
) }}

-- Intermediate model for CVD-related medications for LTC LCS case finding
-- Includes statin medications, statin allergies/contraindications, and statin decisions

{{ get_medication_orders(
    cluster_id=['STATIN_CVD_MEDICATIONS', 'STATIN_CVD_63_MEDICATIONS', 'STATIN_CVD_64_MEDICATIONS', 'STATIN_CVD_65_MEDICATIONS'],
    source='LTC_LCS'
) }}
