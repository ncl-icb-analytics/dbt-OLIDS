{{ config(
    materialized='table',
    post_hook=[
        "COMMENT ON TABLE {{ this }} IS 'Intermediate: LTC LCS DM Observations - Collects all diabetes-relevant observations for Long Term Conditions case finding measures.

Clinical Purpose:
â€¢ Gathers comprehensive diabetes-related clinical observation data for case finding algorithms
â€¢ Supports identification of patients with undiagnosed diabetes through laboratory and clinical observations
â€¢ Enables observation-based risk stratification using HbA1c measurements and diabetes risk scores
â€¢ Provides foundation data for diabetes case finding indicators including gestational diabetes risk

Data Granularity:
â€¢ One row per clinical observation for diabetes-relevant observations
â€¢ Covers HbA1c levels, QDiabetes risk scores, QRISK2 scores, BMI measurements
â€¢ Includes gestational diabetes history and pregnancy risk observations
â€¢ Sourced from LTC_LCS programme observation clusters

Key Features:
â€¢ Cluster IDs: HBA1C_LEVEL, QDIABETES_RISK, QRISK2_10YEAR, HISTORY_GESTATIONAL_DIABETES, GESTATIONAL_DIABETES_PREGNANCY_RISK, BMI_MEASUREMENT
â€¢ Supports diabetes case finding measures using laboratory and risk assessment data
â€¢ Comprehensive diabetes risk factor and diagnostic observation analysis
â€¢ Integration with LTC_LCS programme clinical observation tracking systems

ðŸ¤– Generated by dbt. This table is managed by dbt - for model definitions and documentation, see https://github.com/ncl-icb-analytics/dbt-olids'"
    ]
) }}

-- Intermediate model for diabetes observations for LTC LCS case finding
-- Contains HbA1c measurements, diabetes risk scores, gestational diabetes history, and BMI measurements

{{ get_observations(
    cluster_ids="'HBA1C_LEVEL', 'QDIABETES_RISK', 'QRISK2_10YEAR', 'HISTORY_GESTATIONAL_DIABETES', 'GESTATIONAL_DIABETES_PREGNANCY_RISK', 'BMI_MEASUREMENT'",
    source='LTC_LCS'
) }}
