{{ config(
    materialized='table',
    post_hook=[
        "COMMENT ON TABLE {{ this }} IS 'Intermediate: LTC LCS CVD Observations - Collects all cardiovascular disease-relevant observations for Long Term Conditions case finding measures.

Clinical Purpose:
â€¢ Gathers comprehensive CVD-related clinical observation data for case finding algorithms
â€¢ Supports identification of patients requiring CVD risk assessment through clinical observations
â€¢ Enables observation-based risk stratification using QRISK2 scores and cholesterol measurements
â€¢ Provides foundation data for CVD case finding indicators including statin decision tracking

Data Granularity:
â€¢ One row per clinical observation for CVD-relevant observations
â€¢ Covers QRISK2 10-year scores, non-HDL cholesterol measurements
â€¢ Includes statin allergy/adverse reactions, contraindications, and clinical decisions
â€¢ Sourced from LTC_LCS programme observation clusters

Key Features:
â€¢ Cluster IDs: QRISK2_10YEAR, NON_HDL_CHOLESTEROL, STATIN_ALLERGY_ADVERSE_REACTION, STATIN_NOT_INDICATED, STATINDEC_COD
â€¢ Supports cardiovascular risk assessment and primary prevention case finding
â€¢ Comprehensive clinical decision tracking for statin prescribing
â€¢ Integration with LTC_LCS programme clinical observation tracking systems

ðŸ¤– Generated by dbt. This table is managed by dbt - for model definitions and documentation, see https://github.com/ncl-icb-analytics/dbt-olids'"
    ]
) }}

-- Intermediate model for CVD-related observations for LTC LCS case finding
-- Includes QRISK2 scores, cholesterol measurements, statin allergies/adverse reactions,
-- statin contraindications, and statin clinical decisions

{{ get_observations(
    cluster_ids="'QRISK2_10YEAR', 'NON_HDL_CHOLESTEROL', 'STATIN_ALLERGY_ADVERSE_REACTION', 'STATIN_NOT_INDICATED', 'STATINDEC_COD'",
    source='LTC_LCS'
) }}
