{{ config(
    materialized='table',
    post_hook=[
        "COMMENT ON TABLE {{ this }} IS 'Intermediate: LTC LCS CYP Asthma Medications - Collects all children and young people asthma-relevant medications for Long Term Conditions case finding measures.

Clinical Purpose:
â€¢ Gathers comprehensive CYP asthma-related medication data for case finding algorithms
â€¢ Supports identification of children and young people with undiagnosed asthma through medication patterns
â€¢ Enables medication-based risk stratification for paediatric asthma case finding measures
â€¢ Provides foundation data for CYP asthma case finding indicators

Data Granularity:
â€¢ One row per medication order for CYP asthma-relevant medications
â€¢ Covers asthma medications, prednisolone (oral steroids), and montelukast (leukotriene receptor antagonist)
â€¢ Sourced from LTC_LCS programme medication clusters for paediatric populations
â€¢ Includes all historical and current asthma medication patterns for children and young people

Key Features:
â€¢ Cluster IDs: ASTHMA_MEDICATIONS, ASTHMA_PREDNISOLONE, MONTELUKAST_MEDICATIONS
â€¢ Supports CYP-specific asthma case finding measure requirements
â€¢ Comprehensive paediatric medication pattern analysis for undiagnosed asthma detection
â€¢ Integration with LTC_LCS programme medication tracking systems for children and young people

ðŸ¤– Generated by dbt. This table is managed by dbt - for model definitions and documentation, see https://github.com/ncl-icb-analytics/snowflake-hei-migration'"
    ]
) }}

-- CYP Asthma medications for LTC/LCS case finding
-- Includes asthma medications, prednisolone, and montelukast

{{ get_medication_orders(
    cluster_id="'ASTHMA_MEDICATIONS','ASTHMA_PREDNISOLONE','MONTELUKAST_MEDICATIONS'",
    source='LTC_LCS'
) }}
