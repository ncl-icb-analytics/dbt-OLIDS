version: 2

models:
  - name: int_ltc_lcs_cf_cvd_66_base_population
    description: "CVD_66 base population for statin review case finding. Includes patients aged 75-83 who are not on statins, have no statin allergies/contraindications, no recent statin decisions, and no health checks in last 24 months."
    columns:
      - name: person_id
        description: "Unique patient identifier"
        tests:
          - not_null
          - unique
      - name: age
        description: "Patient age (75-83)"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 75
              max_value: 83
      - name: has_statin
        description: "Whether patient has statin medication in last 12 months (should be FALSE for all)"
        tests:
          - not_null
          - accepted_values:
              values: [false]
      - name: has_statin_allergy
        description: "Whether patient has statin allergy/contraindication (should be FALSE for all)"
        tests:
          - not_null
          - accepted_values:
              values: [false]
      - name: has_statin_decision
        description: "Whether patient has statin decision in last 60 months (should be FALSE for all)"
        tests:
          - not_null
          - accepted_values:
              values: [false]
      - name: has_health_check
        description: "Whether patient has health check in last 24 months (should be FALSE for all)"
        tests:
          - not_null
          - accepted_values:
              values: [false]
      - name: latest_statin_date
        description: "Latest statin medication date (should be NULL for all)"
      - name: latest_statin_allergy_date
        description: "Latest statin allergy/contraindication date (should be NULL for all)"
      - name: latest_statin_decision_date
        description: "Latest statin decision date (should be NULL for all)"
      - name: latest_health_check_date
        description: "Latest health check date (should be NULL for all)" 