{{ config(
    materialized='table',
    post_hook=[
        "COMMENT ON TABLE {{ this }} IS 'Intermediate: LTC LCS Ethnicity Observations - Collects ethnicity-relevant observations for Long Term Conditions case finding measures with diabetes screening focus.

Clinical Purpose:
â€¢ Gathers ethnicity classification data for diabetes case finding algorithms
â€¢ Supports ethnicity-based risk stratification for diabetes screening programmes
â€¢ Enables identification of BAME populations at higher risk for Type 2 diabetes
â€¢ Provides foundation data for ethnicity-adjusted diabetes case finding measures

Data Granularity:
â€¢ One row per ethnicity observation for diabetes case finding
â€¢ Covers BAME ethnicity, White British ethnicity, and diabetes screening excluded ethnicities
â€¢ Sourced from LTC_LCS programme observation clusters for ethnicity classification
â€¢ Includes all historical and current ethnicity observations relevant to diabetes screening

Key Features:
â€¢ Cluster IDs: ETHNICITY_BAME, ETHNICITY_WHITE_BRITISH, DIABETES_EXCLUDED_ETHNICITY
â€¢ Supports ethnicity-based diabetes case finding measure requirements
â€¢ Comprehensive ethnicity classification for diabetes risk stratification
â€¢ Integration with LTC_LCS programme ethnicity tracking systems for diabetes screening

ðŸ¤– Generated by dbt. This table is managed by dbt - for model definitions and documentation, see https://github.com/ncl-icb-analytics/snowflake-hei-migration'"
    ]
) }}

-- Intermediate model for ethnicity observations for LTC LCS diabetes case finding
-- Used for BAME and excluded ethnicity classifications in diabetes screening

{{ get_observations(
    cluster_ids="'ETHNICITY_BAME', 'ETHNICITY_WHITE_BRITISH', 'DIABETES_EXCLUDED_ETHNICITY'",
    source='LTC_LCS'
) }}
