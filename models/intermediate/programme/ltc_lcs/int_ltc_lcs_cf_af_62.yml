version: 2
models:
  - name: int_ltc_lcs_cf_af_62
    description: "Intermediate model for LTC LCS Case Finding: AF_62. Flags patients over 65 missing a pulse check in the last 36 months. Uses modular intermediates and exclusions."
    columns:
      - name: person_id
        description: "Unique identifier for the person"
        tests:
          - not_null
      - name: age
        description: "Age of the patient"
      - name: has_pulse_check
        description: "Flag indicating if person has had a pulse check in last 36 months"
      - name: latest_pulse_check_date
        description: "Latest date of pulse check"
      - name: latest_health_check_date
        description: "Latest health check date"
      - name: has_excluding_condition
        description: "Flag for any exclusion condition based on observations"
      - name: exclusion_reason
        description: "Cluster IDs for exclusion conditions found in observations"
      - name: all_pulse_check_codes
        description: "All pulse check codes found for person (array)"
      - name: all_pulse_check_displays
        description: "All pulse check display terms found for person (array)"
