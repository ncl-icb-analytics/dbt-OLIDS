{{ config(
    post_hook=[
        "COMMENT ON TABLE {{ this }} IS 'Intermediate: LTC LCS AF Observations - Collects all atrial fibrillation-relevant observations for Long Term Conditions case finding measures.

Clinical Purpose:
â€¢ Gathers comprehensive AF-related clinical observation data for case finding algorithms
â€¢ Supports identification of patients with undiagnosed atrial fibrillation through clinical observations
â€¢ Enables observation-based risk stratification for AF case finding measures
â€¢ Provides foundation data for AF_61 and AF_62 case finding indicators

Data Granularity:
â€¢ One row per clinical observation for AF-relevant observations
â€¢ Covers AF observations, exclusions, deep vein thrombosis, atrial flutter, pulse measurements
â€¢ Sourced from LTC_LCS programme observation clusters
â€¢ Includes all historical and current AF clinical observation patterns

Key Features:
â€¢ Cluster IDs: AF_OBSERVATIONS, AF_EXCLUSIONS, DEEP_VEIN_THROMBOSIS, ATRIAL_FLUTTER, ATRIAL_FIBRILLATION_61_EXCLUSIONS, PULSE_RATE, PULSE_RHYTHM
â€¢ Supports both AF_61 and AF_62 case finding measure requirements
â€¢ Comprehensive clinical observation analysis for undiagnosed AF detection
â€¢ Integration with LTC_LCS programme clinical observation tracking systems

ðŸ¤– Generated by dbt. This table is managed by dbt - for model definitions and documentation, see https://github.com/ncl-icb-analytics/snowflake-hei-migration'"
    ]
) }}

-- Intermediate model for LTC LCS AF Observations
-- Collects all AF-relevant observations needed for all AF case finding measures

-- This intermediate fetches all AF-relevant observations for both AF_61 and AF_62 case finding measures
{{ get_observations(
    cluster_ids="'AF_OBSERVATIONS','AF_EXCLUSIONS','DEEP_VEIN_THROMBOSIS','ATRIAL_FLUTTER','ATRIAL_FIBRILLATION_61_EXCLUSIONS','PULSE_RATE','PULSE_RHYTHM'",
    source='LTC_LCS'
) }}
