version: 2
models:
  - name: dim_person_age
    description: 'Person age attributes with age bands, school stages, and life stage categories.

      One row per person with recorded birth dates. Current age for living persons, age at death for deceased persons.'
    columns:
      - name: person_id
        description: Unique identifier for the person
        tests:
          - not_null
          - unique
      
      - name: birth_date_approx
        description: Approximate date of birth (mid-month)
        tests:
          - not_null
      
      - name: age
        description: Current age or age at death in years
        tests:
          - not_null
      
      - name: birth_date_approx_end_of_month
        description: 'Approximate date of birth using the last day of the recorded birth month. Complements birth_date_approx (mid-month) for scenarios that require end-of-month alignment.'
      - name: age_at_least
        description: 'Minimum possible age in full years, calculated using the last day of the recorded birth month as the date of birth. For deceased persons, this is age at death.'
