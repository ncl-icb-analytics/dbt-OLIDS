version: 2
models:
  - name: fct_person_atrial_fibrillation_register
    description: 'QOF atrial fibrillation register for patients with active AF diagnosis.

      One row per person with latest AFIB_COD > latest AFIBRES_COD or no resolution recorded.'

    columns:
      - name: person_id
        description: 'Patient identifier'

      - name: age
        description: 'Current age of the patient'

      - name: is_on_register
        description: 'Flag indicating patient is on the AF QOF register'

      - name: earliest_diagnosis_date
        description: 'Date of earliest AF diagnosis'

      - name: latest_diagnosis_date
        description: 'Date of most recent AF diagnosis'

      - name: latest_resolved_date
        description: 'Date of most recent AF resolution code (if any)'

      - name: all_af_concept_codes
        description: 'Array of all AF concept codes for this patient'

      - name: all_af_concept_displays
        description: 'Array of all AF concept displays for this patient'

      - name: meets_age_criteria
        description: 'Flag indicating patient meets age criteria (always true for AF register)'

      - name: has_active_diagnosis
        description: 'Flag indicating patient has an active AF diagnosis'
