version: 2
models:
- name: fct_person_stroke_tia_register
  description: 'QOF Stroke and TIA Register - Patients with stroke or transient ischaemic attack history.


    Key Inclusion Criteria:

    • Stroke or TIA diagnosis (STIA_COD) present

    • Not resolved by resolution codes (STIARES_COD)

    • No age restrictions

    • Lifelong condition for secondary prevention


    Purpose: QOF register for stroke secondary prevention measures, cardiovascular risk management, and stroke care pathway monitoring.'

  columns:
  - name: person_id
    description: Unique person identifier

    tests:
    - not_null
    - relationships:
        to: ref('dim_person')
        field: person_id
  - name: is_on_register
    description: 'Register flag: has stroke or TIA diagnosis (always TRUE for this table)'

    tests:
    - not_null
    - accepted_values:

        values:
        - true
  - name: earliest_diagnosis_date
    description: Date of first recorded stroke/TIA diagnosis

    tests:
    - not_null
  - name: latest_diagnosis_date
    description: Date of most recent stroke/TIA diagnosis

    tests:
    - not_null
    - test_no_future_dates
  - name: stroke_tia_diagnosis_codes
    description: Array of all distinct stroke/TIA concept codes for this person

    tests:
    - not_null
  - name: stroke_tia_diagnosis_displays
    description: Array of all distinct stroke/TIA concept display terms for this person

    tests:
    - not_null
