version: 2
models:
- name: fct_person_pad_register
  description: 'QOF Peripheral Arterial Disease (PAD) Register - Patients with peripheral vascular disease.


    Key Inclusion Criteria:

    • PAD diagnosis (PAD_COD) present

    • No age restrictions

    • No resolution codes (PAD is permanent condition)


    Purpose: QOF register for cardiovascular disease management, risk stratification, and secondary prevention monitoring.'

  columns:
  - name: person_id
    description: Unique person identifier

    tests:
    - not_null
    - relationships:
        to: ref('dim_person')
        field: person_id
  - name: is_on_register
    description: 'Register flag: has PAD diagnosis (always TRUE for this table)'

    tests:

    - not_null

    - accepted_values:

        values:

        - true

  - name: earliest_diagnosis_date
    description: Date of most recent PAD diagnosis

    tests:

    - not_null

    - test_no_future_dates
