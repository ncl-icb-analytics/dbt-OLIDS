version: 2
models:
- name: fct_person_learning_disability_register
  description: 'QOF Learning Disability Register - Patients aged 14+ with learning disability diagnosis.


    Key Inclusion Criteria:

    • Age: 14 years or older

    • Learning disability diagnosis (LD_COD) present

    • No resolution codes (learning disability is permanent condition)


    Purpose: QOF register for learning disability care pathway monitoring, health equity assessment, and ensuring appropriate support services.'

  columns:
  - name: person_id
    description: Unique person identifier

    tests:
    - not_null
    - relationships:
        to: ref('dim_person')
        field: person_id
  - name: is_on_register
    description: 'Register flag: has LD diagnosis aged 14+ (always TRUE for this table)'

    tests:
    - not_null
    - accepted_values:

        values:
        - true
  - name: earliest_diagnosis_date
    description: Date of most recent learning disability diagnosis

    tests:
    - not_null
    - test_no_future_dates
  - name: all_ld_concept_codes
    description: Array of all distinct learning disability concept codes for this person

    tests:
    - not_null
  - name: all_ld_concept_displays
    description: Array of all distinct learning disability concept display terms for this person

    tests:
    - not_null
