version: 2
models:
- name: dim_practice_pcn
  description: 'Primary Care Network mapping for organisational hierarchy and network analysis.


    Business Logic:

    • Maps GP practices to Primary Care Networks (PCNs) for organisational hierarchy

    • Supports PCN-level analytics, performance monitoring and network operations

    • Enables network-based service planning and integrated care delivery

    • One row per practice with PCN assignment from practice neighbourhood lookup'

  tests:
  - dbt_utils.at_least_one:
      column_name: practice_code

  columns:
  - name: practice_code
    description: GP practice code (ServiceProviderCode)

    tests:
    - not_null
    - unique
  - name: practice_name
    description: GP practice name (ServiceProviderName)

    tests:
    - not_null
  - name: pcn_code
    description: Primary Care Network code

    tests:
    - not_null
  - name: pcn_name
    description: Primary Care Network name (uses PCN code as fallback in dummy data)

    tests:
    - not_null
