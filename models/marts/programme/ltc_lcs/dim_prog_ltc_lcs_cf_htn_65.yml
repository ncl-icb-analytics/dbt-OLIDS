version: 2

models:
  - name: dim_prog_ltc_lcs_cf_htn_65
    description: "HTN_65 case finding mart: Stage 1 hypertension patients with cardiovascular risk factors requiring BP management"
    columns:
      - name: person_id
        description: "Unique identifier for the person"
        tests:
          - not_null
          - unique
      - name: age
        description: "Person's age at time of analysis"
        tests:
          - not_null
      - name: has_cardiovascular_risk_factors
        description: "Flag indicating patient has cardiovascular risk factors (always TRUE)"
        tests:
          - not_null
          - accepted_values:
              values: [true]
      - name: has_stage_1_hypertension_with_risk
        description: "Flag indicating patient has stage 1 hypertension with risk factors (always TRUE)"
        tests:
          - not_null
          - accepted_values:
              values: [true]
      - name: latest_bp_date
        description: "Date of the latest blood pressure reading"
        tests:
          - not_null
      - name: latest_bp_value
        description: "Value of the latest blood pressure reading"
        tests:
          - not_null
      - name: latest_bp_type
        description: "Type of latest BP reading (clinic, home, or ABPM)"
        tests:
          - not_null
      - name: is_clinic_bp
        description: "Flag indicating if latest reading is clinic blood pressure"
        tests:
          - not_null
      - name: is_home_bp
        description: "Flag indicating if latest reading is home/ABPM blood pressure"
        tests:
          - not_null 