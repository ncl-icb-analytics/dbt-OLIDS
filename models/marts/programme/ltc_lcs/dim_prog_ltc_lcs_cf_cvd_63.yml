version: 2

models:
  - name: dim_prog_ltc_lcs_cf_cvd_63
    description: Intermediate model for LTC LCS case finding indicator CVD_63. Identifies patients aged 40-83 who are on statins with non-HDL cholesterol > 2.5 and need statin review.
    columns:
      - name: person_id
        tests:
          - not_null
          - unique
      - name: age
        tests:
          - not_null
      - name: needs_statin_review
        tests:
          - not_null
          - accepted_values:
              values: [true]
      - name: latest_statin_date
        tests:
          - not_null
      - name: latest_non_hdl_date
        tests:
          - not_null
      - name: latest_non_hdl_value
        tests:
          - not_null
      - name: meets_criteria
        tests:
          - not_null
          - accepted_values:
              values: [true] 