version: 2
models:
- name: dim_ltc_lcs_cf_dm_66
  description: 'Case finding for patients with pre-diabetic HbA1c levels requiring continued surveillance.

    Business Logic:
    
    • Identifies patients with latest HbA1c between 42-46 mmol/mol (pre-diabetic range)
    
    • Requires HbA1c assessment within the last 12 months for current status
    
    • Targets patients for diabetes prevention interventions and ongoing monitoring
    
    • One row per eligible person with recent HbA1c results and monitoring history'
  columns:
  - name: person_id
    description: Unique identifier for the person
    tests:
    - not_null
    - unique
  - name: age
    description: Age of the patient (17+)
    tests:
    - not_null
  - name: has_no_risk_factors
    description: Boolean flag indicating person has no diabetes risk factors
  - name: latest_bmi_date
    description: Date of most recent BMI measurement (if available)
  - name: latest_bmi_value
    description: Most recent BMI value (should be below risk thresholds)
  - name: latest_hba1c_date
    description: Date of most recent HbA1c reading (if available)
  - name: latest_hba1c_value
    description: Most recent HbA1c value (should be below risk thresholds)
  - name: all_bmi_codes
    description: Array of all BMI concept codes for the patient
  - name: all_bmi_displays
    description: Array of all BMI concept display terms for the patient
