version: 2

models:
  - name: dim_ltc_lcs_cf_cvd_61
    description: Intermediate model for LTC LCS case finding indicator CVD_61. Identifies patients aged 40-83 with QRISK2 score â‰¥ 20% who require cardiovascular disease prevention interventions.
    columns:
      - name: person_id
        tests:
          - not_null
          - unique
      - name: age
        tests:
          - not_null
      - name: has_high_qrisk2
        tests:
          - not_null
          - accepted_values:
              values: [true]
      - name: latest_qrisk2_date
        tests:
          - not_null
      - name: latest_qrisk2_value
        tests:
          - not_null
      - name: meets_criteria
        tests:
          - not_null
          - accepted_values:
              values: [true] 