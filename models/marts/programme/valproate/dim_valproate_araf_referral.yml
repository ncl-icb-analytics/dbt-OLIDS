version: 2
models:
- name: dim_valproate_araf_referral
  description: 'Mart: Valproate ARAF Referral Status - Person-level aggregation of ARAF referral events for valproate safety monitoring compliance.


    Business Purpose:

    • Support valproate safety monitoring through ARAF referral tracking and specialist engagement

    • Enable systematic monitoring of specialist referral requirements for valproate therapy oversight

    • Provide clinical decision support for ARAF referral compliance and specialist involvement

    • Support quality improvement initiatives for comprehensive valproate safety programme delivery


    Data Granularity:

    • One row per person with ARAF referral events in valproate safety monitoring

    • Aggregates all ARAF referral events with earliest and latest referral tracking

    • Includes comprehensive referral history for specialist engagement monitoring


    Key Features:

    • Person-level ARAF referral event aggregation with complete specialist engagement history

    • Earliest and latest referral tracking for monitoring specialist involvement effectiveness

    • Evidence-based referral compliance assessment supporting comprehensive safety monitoring

    • Integration with valproate safety pathways for systematic specialist engagement coordination'
  columns:
  - name: person_id
    description: Unique identifier for the person.
    tests:
    - not_null
    - unique
  - name: has_araf_referral_event
    description: TRUE if any ARAF referral event is present for the person. Always TRUE for persons in this table.
    tests:
    - not_null
  - name: earliest_araf_referral_event_date
    description: Earliest date of any ARAF referral event for the person.
  - name: latest_araf_referral_event_date
    description: Latest date of any ARAF referral event for the person.
  - name: all_araf_referral_observation_ids
    description: Array of unique observation IDs related to ARAF referral events.
  - name: all_araf_referral_concept_codes
    description: Array of all distinct ARAF referral medical concept codes found.
  - name: all_araf_referral_concept_displays
    description: Array of display terms for the ARAF referral codes.
  - name: all_araf_referral_code_categories_applied
    description: Array of code categories applied (should contain only 'REFERRAL').
