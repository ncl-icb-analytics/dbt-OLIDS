version: 2
models:
- name: dim_valproate_araf
  description: 'Mart: Valproate ARAF Status - Person-level aggregation of Annual Risk Acknowledgement Form events for valproate safety monitoring.


    Population Scope:

    • Patients with ARAF-related events in valproate safety monitoring

    • All persons with recorded Annual Risk Acknowledgement Form interactions

    • One row per person with ARAF events and completion tracking


    Key Features:

    • Person-level ARAF event aggregation with complete compliance history

    • Earliest and latest ARAF completion tracking for monitoring effectiveness

    • Evidence-based ARAF compliance assessment supporting regulatory requirements'
  columns:
  - name: person_id
    description: Unique identifier for the person.
    tests:
    - not_null
    - unique
  - name: has_araf_event
    description: TRUE if any ARAF event is present for the person. Always TRUE for persons in this table.
    tests:
    - not_null
  - name: earliest_araf_event_date
    description: Earliest date of any ARAF-related event for the person.
  - name: latest_araf_event_date
    description: Latest date of any ARAF-related event for the person.
  - name: latest_specific_araf_form_date
    description: Latest date of an ARAF form event for the person.
  - name: has_specific_araf_form_meeting_lookback
    description: TRUE if an ARAF form event meeting lookback criteria is recorded.
    tests:
    - not_null
  - name: all_araf_observation_ids
    description: Array of unique observation IDs related to ARAF events.
  - name: all_araf_concept_codes
    description: Array of all distinct ARAF-related medical concept codes found.
  - name: all_araf_concept_displays
    description: Array of display terms for the ARAF codes.
  - name: all_araf_code_categories_applied
    description: Array of code categories applied (should contain only 'ARAF').
