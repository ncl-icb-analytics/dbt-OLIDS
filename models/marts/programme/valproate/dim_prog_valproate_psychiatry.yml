version: 2

models:
  - name: dim_prog_valproate_psychiatry
    description: "Aggregates psychiatry-related events for each person, providing analytics-ready person-level psychiatry event status and history."
    columns:
      - name: person_id
        description: "Unique identifier for the person."
        tests:
          - not_null
          - unique
      - name: has_psych_event
        description: "TRUE if any psychiatry event is present for the person. Always TRUE for persons in this table."
        tests:
          - not_null
      - name: earliest_psych_event_date
        description: "Earliest date of any psychiatry-related event for the person."
      - name: latest_psych_event_date
        description: "Latest date of any psychiatry-related event for the person."
      - name: all_psych_observation_ids
        description: "Array of unique observation IDs related to psychiatry events."
      - name: all_psych_concept_codes
        description: "Array of all distinct psychiatry-related medical concept codes found."
      - name: all_psych_concept_displays
        description: "Array of display terms for the psychiatry codes."
      - name: all_psych_code_categories_applied
        description: "Array of code categories applied (should contain only 'PSYCH')."
