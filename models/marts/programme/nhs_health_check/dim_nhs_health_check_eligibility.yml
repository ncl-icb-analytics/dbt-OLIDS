version: 2
models:
- name: dim_nhs_health_check_eligibility
  description: 'Mart: NHS Health Check Eligibility - Eligibility assessment and due status for NHS Health Check programme participation.


    Business Purpose:

    • Support NHS Health Check programme management and invitation planning

    • Enable cardiovascular risk assessment programme delivery and population health monitoring

    • Provide clinical decision support for health check eligibility and scheduling

    • Support quality improvement initiatives for preventive care programme effectiveness


    Data Granularity:

    • One row per person with NHS Health Check eligibility assessment

    • Includes eligibility criteria evaluation and due status for health check scheduling

    • Comprehensive programme participation tracking with invitation and completion history


    Key Features:

    • NHS Health Check eligibility assessment based on age and exclusion criteria

    • Due status calculation for health check invitation and scheduling

    • Programme participation history with completion and invitation tracking

    • Evidence-based eligibility criteria supporting NICE guidelines for cardiovascular prevention'
  config:
    materialized: table
  columns:
  - name: person_id
    description: Unique person identifier linking to dim_person
    tests:
    - not_null
    - relationships:
        to: ref('dim_person')
        field: person_id
  - name: age
    description: Person's current age in years
    tests:
    - not_null
    - dbt_utils.accepted_range:
        min_value: 0
        max_value: 120
  - name: has_any_excluding_condition
    description: 'Flag: TRUE if person has any condition excluding them from NHS Health Checks'
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: is_eligible_for_nhs_health_check
    description: 'Flag: TRUE if person is eligible (age 40-74 without excluding conditions)'
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
  - name: latest_health_check_date
    description: Date of most recent NHS Health Check (NULL if never had one)
  - name: days_since_last_health_check
    description: Number of days since last health check (NULL if never had one)
    tests:
    - dbt_utils.accepted_range:
        min_value: 0
        max_value: 50000
        severity: warn
  - name: due_nhs_health_check
    description: 'Flag: TRUE if person is due an NHS Health Check (eligible + >5 years or never)'
    tests:
    - not_null
    - accepted_values:
        values:
        - true
        - false
