version: 2
models:
- name: dim_person_birth_death
  description: 'Mart: Person Birth Death Dimension - Core vital statistics for demographic analysis.


    Population Scope:

    • All persons with recorded birth year and month

    • Both living and deceased persons

    • One row per person with vital statistics


    Key Features:

    • Statistical midpoint methodology for date approximation

    • Foundation data for age calculations and mortality analysis

    • Deceased status flag for population segmentation'

  columns:
  - name: person_id
    description: Unique person identifier - primary key

    tests:
    - not_null
    - unique
  - name: sk_patient_id
    description: Surrogate patient key

    tests:
    - not_null
  - name: birth_year
    description: Year of birth (YYYY format)

    tests:
    - not_null
    - dbt_utils.accepted_range:
        min_value: 1900
        max_value: 2030
  - name: birth_month
    description: Month of birth (1-12)

    tests:
    - not_null
    - dbt_utils.accepted_range:
        min_value: 1
        max_value: 12
  - name: birth_date_approx
    description: Approximate birth date calculated as exact midpoint of birth month for statistical precision

    tests:
    - not_null
  - name: death_year
    description: Year of death (YYYY format, NULL if alive)

    tests:
    - dbt_utils.accepted_range:
        min_value: 1900
        max_value: 2030
  - name: death_month
    description: Month of death (1-12, NULL if alive)

    tests:
    - dbt_utils.accepted_range:
        min_value: 1
        max_value: 12
  - name: death_date_approx
    description: Approximate death date calculated as exact midpoint of death month (NULL if alive)
  - name: is_deceased
    description: Boolean flag indicating if person is deceased (derived from presence of death_year)

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
  - name: is_dummy_patient
    description: Boolean flag indicating if this is a dummy/test patient record

    tests:
    - not_null
    - accepted_values:

        values:
        - true
        - false
